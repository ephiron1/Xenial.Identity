@page "/Admin2/Logs"
@using Xenial.Identity.Infrastructure
@inject InMemorySink Sink
@implements IDisposable

<MudText Typo="Typo.h3" GutterBottom>Logs</MudText>

<MudButton OnClick="@TerminalInititialized">Say Hello</MudButton>

<XTerm @ref="@terminal" Initialized="@TerminalInititialized" />

@code {
    private async Task TerminalInititialized()
    {
        if (terminal is not null)
        {
            var items = Sink.ToArray();
            foreach (var item in items)
            {
                await terminal.WriteLine("Hello World");
            }
            Sink.Emitted -= Emitted;
            Sink.Emitted += Emitted;
        }
    }

    private XTerm terminal;

    private async void Emitted(object sender, EventArgs e)
    {
        if (terminal is not null)
        {
            await terminal.WriteLine("Emitted");
        }
    }

    public void Dispose()
        => Sink.Emitted -= Emitted;
}
